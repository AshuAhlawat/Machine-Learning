print("CUDA memory summary on allotment Google Colab")
print("""
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 8            |        cudaMalloc retries: 9         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   10945 MB |   10945 MB |   28681 MB |   17736 MB |
|       from large pool |   10923 MB |   10923 MB |   28655 MB |   17732 MB |
|       from small pool |      21 MB |      21 MB |      26 MB |       4 MB |
|---------------------------------------------------------------------------|
| Active memory         |   10945 MB |   10945 MB |   28681 MB |   17736 MB |
|       from large pool |   10923 MB |   10923 MB |   28655 MB |   17732 MB |
|       from small pool |      21 MB |      21 MB |      26 MB |       4 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   10964 MB |   10964 MB |   16824 MB |    5860 MB |
|       from large pool |   10942 MB |   10942 MB |   16800 MB |    5858 MB |
|       from small pool |      22 MB |      22 MB |      24 MB |       2 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   19344 KB |    1613 MB |   12004 MB |   11985 MB |
|       from large pool |   18858 KB |    1611 MB |   11982 MB |   11964 MB |
|       from small pool |     486 KB |       3 MB |      21 MB |      21 MB |
|---------------------------------------------------------------------------|
| Allocations           |     838    |     838    |    1225    |     387    |
|       from large pool |     251    |     251    |     375    |     124    |
|       from small pool |     587    |     587    |     850    |     263    |
|---------------------------------------------------------------------------|
| Active allocs         |     838    |     838    |    1225    |     387    |
|       from large pool |     251    |     251    |     375    |     124    |
|       from small pool |     587    |     587    |     850    |     263    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      71    |      95    |      24    |
|       from large pool |      60    |      60    |      83    |      23    |
|       from small pool |      11    |      11    |      12    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      32    |     253    |     235    |
|       from large pool |      13    |      18    |      73    |      60    |
|       from small pool |       5    |      17    |     180    |     175    |
|===========================================================================|
""")

#torch.cuda.empty_cache()

print("CUDA memory after clearing cache")
print("""
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 9            |        cudaMalloc retries: 10        |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   27066 KB |   10945 MB |   28738 MB |   28712 MB |
|       from large pool |   24362 KB |   10923 MB |   28704 MB |   28681 MB |
|       from small pool |    2704 KB |      21 MB |      33 MB |      31 MB |
|---------------------------------------------------------------------------|
| Active memory         |   27066 KB |   10945 MB |   28738 MB |   28712 MB |
|       from large pool |   24362 KB |   10923 MB |   28704 MB |   28681 MB |
|       from small pool |    2704 KB |      21 MB |      33 MB |      31 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   49152 KB |   10964 MB |   16824 MB |   16776 MB |
|       from large pool |   40960 KB |   10942 MB |   16800 MB |   16760 MB |
|       from small pool |    8192 KB |      22 MB |      24 MB |      16 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22085 KB |    3034 MB |   17640 MB |   17619 MB |
|       from large pool |   16597 KB |    3026 MB |   17592 MB |   17576 MB |
|       from small pool |    5488 KB |      15 MB |      48 MB |      42 MB |
|---------------------------------------------------------------------------|
| Allocations           |     107    |     864    |    1491    |    1384    |
|       from large pool |       7    |     251    |     393    |     386    |
|       from small pool |     100    |     613    |    1098    |     998    |
|---------------------------------------------------------------------------|
| Active allocs         |     107    |     864    |    1491    |    1384    |
|       from large pool |       7    |     251    |     393    |     386    |
|       from small pool |     100    |     613    |    1098    |     998    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       6    |      71    |      95    |      89    |
|       from large pool |       2    |      60    |      83    |      81    |
|       from small pool |       4    |      11    |      12    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |      68    |     515    |     490    |
|       from large pool |       2    |      29    |     118    |     116    |
|       from small pool |      23    |      41    |     397    |     374    |
|===========================================================================|
""")


